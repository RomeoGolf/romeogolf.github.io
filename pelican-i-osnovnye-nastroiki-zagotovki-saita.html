<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pelican и основные настройки заготовки сайта</title>
  <!--[if lt IE 9]><script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <link rel="stylesheet" href="http://romeogolf.github.io/theme/css/styles.css" type="text/css" />
  <link rel="stylesheet" type="text/css"  href="http://romeogolf.github.io/theme/css/pygments.css"/>
  <link rel="shortcut icon" type="image/png" href="http://romeogolf.github.io/images/RG32.ico" />
  <script language="JavaScript" src="http://romeogolf.github.io/theme/js/protector.js"></script>
</head>
<body>
  <header class="main-header">
    <div>
      <img src="http://romeogolf.github.io/images/72.png" style="margin-left: 34px; margin-top: 30px;"> <a id="name" href=http://romeogolf.github.io id="home-link">RomeoGolf</a>
    </div>
  </header>
    <nav class="nav_base">
      <ul class="main-nav">
          <li class="active"><a href="http://romeogolf.github.io/category/blog.html">Блог</a></li>
          <li><a href="http://romeogolf.github.io/category/tvorchestvo.html">Творчество</a></li>


          <li>
            <a href="http://romeogolf.github.io/pages/triangulum-soft.html">Triangulum Soft</a>
          </li>
          <li>
            <a href="http://romeogolf.github.io/pages/o-saite.html">О сайте</a>
          </li>
      </ul>
    </nav>
  <div class="layout">

    <div class="sidebar">
      <div class="tagcloud">
        Теги:
        <ul class="tagcloud">
          <li class="tag-4">
            <a href="http://romeogolf.github.io/tag/batcmd.html">
              bat/cmd
                <span class="badge">1</span>
            </a>
          </li>
          <li class="tag-2">
            <a href="http://romeogolf.github.io/tag/linux.html">
              linux
                <span class="badge">3</span>
            </a>
          </li>
          <li class="tag-2">
            <a href="http://romeogolf.github.io/tag/markdown.html">
              markdown
                <span class="badge">2</span>
            </a>
          </li>
          <li class="tag-0">
            <a href="http://romeogolf.github.io/tag/pelican.html">
              pelican
                <span class="badge">6</span>
            </a>
          </li>
          <li class="tag-2">
            <a href="http://romeogolf.github.io/tag/rfquiz.html">
              rfquiz
                <span class="badge">2</span>
            </a>
          </li>
          <li class="tag-4">
            <a href="http://romeogolf.github.io/tag/tar.html">
              tar
                <span class="badge">1</span>
            </a>
          </li>
          <li class="tag-2">
            <a href="http://romeogolf.github.io/tag/triangulum.html">
              triangulum
                <span class="badge">2</span>
            </a>
          </li>
          <li class="tag-1">
            <a href="http://romeogolf.github.io/tag/usb-polygon.html">
              usb-polygon
                <span class="badge">5</span>
            </a>
          </li>
          <li class="tag-2">
            <a href="http://romeogolf.github.io/tag/windows.html">
              windows
                <span class="badge">2</span>
            </a>
          </li>
          <li class="tag-2">
            <a href="http://romeogolf.github.io/tag/raznoe.html">
              разное
                <span class="badge">2</span>
            </a>
          </li>
          <li class="tag-2">
            <a href="http://romeogolf.github.io/tag/remont.html">
              ремонт
                <span class="badge">2</span>
            </a>
          </li>
          <li class="tag-2">
            <a href="http://romeogolf.github.io/tag/svoimi-rukami.html">
              своими руками
                <span class="badge">2</span>
            </a>
          </li>
          <li class="tag-2">
            <a href="http://romeogolf.github.io/tag/stikhi.html">
              стихи
                <span class="badge">3</span>
            </a>
          </li>
        </ul>
      </div> <!-- tagcloud -->
    </div> <!-- sidebar -->

    <div class="content">
  <section class="main-section blog-section" id="blog-posts">
    <h4 class="date">Сб 16 Январь 2016</h4>
    <article>
      <h1>Pelican и основные настройки заготовки сайта</h1>
      
      <h2 id="_1">Настройки и тема</h2>
<p>То, что вышло на предыдущем шаге, уже является веб-страницей. Заготовка отображается в браузере (не так, как хотелось бы, но именно так, как задано в ее коде), худо-бедно размечена и содержит гиперссылки. Однако, гиперссылки между страницами сайта не работают, а внешний вид &mdash; именно, что &laquo;худо&raquo; и &laquo;бедно&raquo;.</p>
<p>Настала пора заняться темой и конфигурацией.</p>
<h3 id="_2">О темах</h3>
<p>Тема определяет внешний вид сайта, для чего включает в себя правила отображения страниц: шаблоны страниц всяческого вида, предусмотренные для данного сайта, а также стили и прочие инструменты веб-дизайна, типа скриптов и иконок.</p>
<p>В общем случае тема представляет собой папку, имя которой и будет названием темы. В ней лежат подпапки static и templates, кроме того, приличные люди, желающие выложить тему собственного производства для всеобщего пользования, кладут в корень папки файлы README (обычно README.md или README.rst, если написано на Markdown или reStructuredText соответственно) и screenshot.png, чтобы пояснить особенности установки и настройки и показать внешний вид. Особенности настройки могут потребовать установки дополнительных модулей Python или дополнительных плагинов Pelican.</p>
<p>В папке templates непременно должен быть файл base.html, в котором описан базовый шаблон с разметкой, общей для всех страниц сайта, остальные шаблоны в большинстве случаев являются его наследниками. Впрочем, можно извратиться и сделать совершенно независимые и непохожие друг на друга шаблоны для каждой страницы, только это отдает легким безумием. Можно сделать пару-тройку безумно непохожих на остальные страниц, если это чем-то обосновано.</p>
<p>Чаще всего помимо базового в теме есть шаблоны для статей (article.html), страниц (page.html), списков тегов, категорий и авторов (tags.html, categories.html, authors.html), списков статей, объединенных общим тегом, категорией или автором (tag.html, category.html, author,html), списка архивных статей (archives.html), и всякие рюшечки для добавления на страницу комментариев от <a href="http://disqus.com/">Disqus</a> (disqus.html), аналитики от Google (analytics.html) 
 и кнопок соцсетей (например, twitter.html).</p>
<p>В папке static обязательно должны быть таблицы стилей. Чаще всего (особенно, если кроме стилей используется что-то еще) они лежат в подпапке css, основной файл может называться styles.css, main.css, local.css и вообще название ограничено только полетом фантазии автора. Чаще всего рядом лежит pygments.css, необходимый для корректной подсветки синтаксиса примеров кода на странице. При помощи этого файла можно менять стили отображения кода, например, светлый текст на темном фоне или наоборот, то есть, для подсветки кода есть свои темы, поэтому лучше придерживаться именно этого названия для css-файла, чтобы при замене темы кода надо было только заменить его, а не искать в разных местах, где переименовывать. Ведь дополнительный файл может быть как подключен в коде шаблона, так и импортирован в основном стилевом файле, как автор захотел.</p>
<p>Кроме подпапки css, в static могут быть подпапки fonts с используемыми нестандартными шрифтами, images или img с картинками (фонами и иконками) и js с используемыми скриптами JavaScript.</p>
<h3 id="_3">Где взять тему</h3>
<p>У нашей заготовки темы нету никакой, а хочется хоть какую-нибудь. Но Pelican не так плох, чтобы не давать возможности поиграться с темой &laquo;из коробки&raquo;. В комплекте поставки идет две темы: simple и notmyidea. Папки с соответствующими названиями лежат где-то в недрах Pelican, который, в свою очередь, расположен где-то внутри Python. В моем случае это <code>C:\Python33\Lib\site-packages\pelican\themes</code>. Однако, лазить по внутренностям змеи и птицы &mdash; не наше дело. Для упрощения задачи нам любезно подкинули специальную утилиту pelican-themes. Команда (как обычно, в консоли, например, файлового менеджера FAR или в окне cmd.exe)</p>
<div class="highlight"><pre>С:\python<span class="m">33</span>\Scripts\pelican-themes.exe -l
</pre></div>


<p>выведет список установленных тем. Собственно, вот эти две упомянутые и выведет. С помощью этой же утилиты темы можно устанавливать, удалять, создавать символические ссылки на имеющиеся темы (благодаря чему тема не будет скопирована внутрь пеликана, но пеликан будет о ней знать и сможет использовать). Например,</p>
<div class="highlight"><pre>С:\python<span class="m">33</span>\Scripts\pelican-themes.exe -i D:\Download\subtle 
</pre></div>


<p>установит тему subtle, если она скачана и лежит в <code>D:\Download</code>, а </p>
<div class="highlight"><pre>С:\python<span class="m">33</span>\Scripts\pelican-themes.exe -r subtle 
</pre></div>


<p>удалит ее. Впрочем, процедура установки и удаления тем не особенно важна. Установленную тему проще подключить в настройках файла конфигурации, чем неустановленную. Однако, можно использовать не просто имя темы, а полный путь к ней, и тогда теме не нужно быть установленной. Это касается раздобытых в интернете тем, либо написанных самостоятельно. Комплектные темы &mdash; упомянутые две &mdash; лучше все-таки не трогать.</p>
<p>Что касается поиска готовых, но более-менее интересных тем &mdash; больше всего их, наверное, на GitHub, например, в <a href="https://github.com/getpelican/pelican-themes">этом сборнике</a>. Но пока разберемся с имеющейся.</p>
<h2 id="_4">Откроем файл конфигурации</h2>
<p>В корне проекта после его создания и первой сборки сайта появилась папка <strong>pycache</strong>. Оставим ее в покое, она нужна питону, пусть пользуется. Файлы Makefile, fabfile.py и develop_server.sh можно спокойно удалить. Если они вдруг когда-нибудь понадобятся, их будет несложно получить снова. Файл publishconf.py оставим в покое, он нас пока не интересует, но может позже и пригодится. Откроем 
pelicanconf.py в текстовом редакторе. Не запустим его, а то Python попытается выполнить, а именно откроем для редактирования.</p>
<div class="highlight"><pre><span class="c">#!/usr/bin/env python</span>
<span class="c"># -*- coding: utf-8 -*- #</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">unicode_literals</span>

<span class="n">AUTHOR</span> <span class="o">=</span> <span class="s">&#39;Me&#39;</span>
<span class="n">SITENAME</span> <span class="o">=</span> <span class="s">&#39;Site&#39;</span>
<span class="n">SITEURL</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>

<span class="n">PATH</span> <span class="o">=</span> <span class="s">&#39;content&#39;</span>

<span class="n">TIMEZONE</span> <span class="o">=</span> <span class="s">&#39;Europe/Paris&#39;</span>

<span class="n">DEFAULT_LANG</span> <span class="o">=</span> <span class="s">&#39;ru&#39;</span>

<span class="c"># Feed generation is usually not desired when developing</span>
<span class="n">FEED_ALL_ATOM</span> <span class="o">=</span> <span class="bp">None</span>
<span class="n">CATEGORY_FEED_ATOM</span> <span class="o">=</span> <span class="bp">None</span>
<span class="n">TRANSLATION_FEED_ATOM</span> <span class="o">=</span> <span class="bp">None</span>
<span class="n">AUTHOR_FEED_ATOM</span> <span class="o">=</span> <span class="bp">None</span>
<span class="n">AUTHOR_FEED_RSS</span> <span class="o">=</span> <span class="bp">None</span>

<span class="c"># Blogroll</span>
<span class="n">LINKS</span> <span class="o">=</span> <span class="p">((</span><span class="s">&#39;Pelican&#39;</span><span class="p">,</span> <span class="s">&#39;http://getpelican.com/&#39;</span><span class="p">),</span>
         <span class="p">(</span><span class="s">&#39;Python.org&#39;</span><span class="p">,</span> <span class="s">&#39;http://python.org/&#39;</span><span class="p">),</span>
         <span class="p">(</span><span class="s">&#39;Jinja2&#39;</span><span class="p">,</span> <span class="s">&#39;http://jinja.pocoo.org/&#39;</span><span class="p">),</span>
         <span class="p">(</span><span class="s">&#39;You can modify those links in your config file&#39;</span><span class="p">,</span> <span class="s">&#39;#&#39;</span><span class="p">),)</span>

<span class="c"># Social widget</span>
<span class="n">SOCIAL</span> <span class="o">=</span> <span class="p">((</span><span class="s">&#39;You can add links in your config file&#39;</span><span class="p">,</span> <span class="s">&#39;#&#39;</span><span class="p">),</span>
          <span class="p">(</span><span class="s">&#39;Another social link&#39;</span><span class="p">,</span> <span class="s">&#39;#&#39;</span><span class="p">),)</span>

<span class="n">DEFAULT_PAGINATION</span> <span class="o">=</span> <span class="mi">10</span>

<span class="c"># Uncomment following line if you want document-relative URLs when developing</span>
<span class="c">#RELATIVE_URLS = True</span>
</pre></div>


<p>Pelican собрал его на основе наших ответов при анкетировании после запуска утилиты pelican-quickstart. Разберем по полочкам. Начало (первые три строки) нужно питону, а не нам. Далее AUTHOR и SITENAME &mdash; можно поставить что-то более осмысленное, собственное имя (или партийный псевдоним) для AUTHOR и что-нибудь креативное для SITENAME.</p>
<p>SITEURL = &lsquo;&rsquo; можно оставить и так, пока мы не лезем в интернеты, а балуемся на собственном домашнем компьютере.</p>
<p>PATH указывает на папку, в которой лежат заготовки статей, страниц и прочего контента, если прочее будет.</p>
<p>TIMEZONE &mdash; пока не лезем в интернеты, можно игнорировать. Можно и исправить на свою, хуже не будет.</p>
<p>DEFAULT_LANG &mdash; имеет смысл сделать &lsquo;ru&rsquo;, хотя действительно важным этот параметр является для многоязычных сайтов.</p>
<p>Блок параметров под комментарием #Feed generation предназначен для настройки ленты Atom RSS, причем, генерация пока отключена.</p>
<p>LINKS, который под комментарием # Blogroll, содержит список ссылок. Эти ссылки будут отображаться в блоке Blogroll, место и внешний вид &mdash; в зависимости от шаблона. По умолчанию заданы ссылки на Pelican, Python.org, Jinja2 и дана заготовочка, которую можно поправить по своему желанию.</p>
<p>Аналогичное назначение у SOCIAL, что под комментарием # Social widget &mdash; ссылки на соцсети, пока только в виде заготовки. LINKS и SOCIAL можно пока что убрать совсем или закрыть комментарием при помощи символа # в начале каждой отключаемой строки</p>
<p>DEFAULT_PAGINATION &mdash; максимальное количество статей на страницу. Можно вместо числа поставить False, тогда будет неограничено.</p>
<p>#RELATIVE_URLS = True следует &laquo;раскомментировать&raquo;, то есть, удалить символ # перед параметром. Параметр задает относительность при формировании URL. Для локального сайта, не использующего веб-сервер, это необходимо. После публикации имеет смысл закрыть обратно, но о необходимости и причинах этого лучше говорить не здесь. Может быть, позже&hellip;</p>
<p>В этом файле, можно в конце, необходимо дописать такие строки:</p>
<div class="highlight"><pre><span class="c"># подключаем предустановленную тему</span>
<span class="n">THEME</span> <span class="o">=</span> <span class="s">&#39;notmyidea&#39;</span>

<span class="c"># перед генерацией стираем старый вариант сайта</span>
<span class="n">DELETE_OUTPUT_DIRECTORY</span> <span class="o">=</span> <span class="bp">True</span>
</pre></div>


<p>Последняя строка нужна потому, что мы пока что экспериментируем. Будем добавлять и удалять элементы контента, а в выходной папке останутся следы уже ненужных страниц. Пусть Pelican сам подтирает их за нами.</p>
<h2 id="_5">Вот такая тема</h2>
<p>А давайте еще создадим в папке content подпапку pages рядом с articles. А туда положим файл about.md такого содержания:</p>
<div class="highlight"><pre>Title: О сайте

На этой странице по логике вещей и в соответствии с названием должно бы 
присутствовать внятное описание сайта, частью которого является данная страница.

К сожалению, у автора сайта до сих пор нет достаточно внятного представления о 
назначении сайта, поэтому нормальное описание не может быть составлено. Однако 
данная страница совершенно необходима хотя бы для того, чтобы посмотреть на ее 
поведение в рамках шаблона и настроек.

В общем, как все уже вероятно догадались, эта страница, как и весь остальной 
сайт в целом, является испытательным полигоном, тестовой площадкой, инструментом 
для получения и отработки новых навыков автора в малознакомой области веб-
творчества и, не побоюсь этого слова, веб-дизайна.
</pre></div>


<p>Для страниц не важна метаинформация, используемая в статьях. Только заголовок, остальное (дата, автор и все такое) использоваться не будет. То есть, использование метаданных определяется шаблоном, а назначение страниц чаще всего отличается от статейного &mdash; их нет в ленте, у них неважен автор и теги.</p>
<p>Запускаем сборку сайта:</p>
<div class="highlight"><pre>c:\python<span class="m">33</span>\Scripts\pelican.exe content
</pre></div>


<p>Теперь из папки output можно запустить index.html и посмотреть результат.</p>
<p>Теперь мы имеем серенький фончик, шапку в виде названия сайта крупными буквами и горизонтального меню с категориями (&laquo;Разное&raquo; и &laquo;Рыба&raquo;) и страницами (&laquo;О сайте&raquo;). Меню, контент и футер на белом фоне со скругленными уголками. На первой странице последняя статья полностью и список остальных статей (в котором пока одна &mdash; первая). В статье добавлен справа плавающий блок с метаданными &mdash; категория, автор, теги и дата публикации. Сайдбаров нет. В футере ссылки, встроенные в шаблон и не убираемые при помощи файла конфигурации. Заголовок в шапке является ссылкой на корень папки output, что логично &mdash; будь это корнем для сервера, тот подставил бы index.html, а нам придется делать это вручную. Верстка фиксированная. Ссылки &mdash; что приятно &mdash; теперь рабочие.</p>
<p>В общем, бери, да радуйся. Можно пользоваться и так. Но, несмотря на то, что результат разительно отличается от &laquo;бестемного&raquo;, хочется улучшений. Да не просто хочется, а мы все-таки надеемся, что это творение будут смотреть люди. И читать эти люди будут, скорее всего, по-русски, а у нас метаданные отмечены на английском. Да и ссылки в футере&hellip; Нет, я тоже благодарен авторам Python, Pelican и этой темы, но не до такой степени, чтобы на каждой странице давать ссылки на них. А еще хочется добавить рюшечек-финтифлюшечек, типа карты сайта, облака тегов, отсортировать меню иначе&hellip;</p>
<p>Короче говоря, надо бы взять тему за основу и поправить ее по своим надобностям. А может, вообще свою с нуля написать, а?</p>
      <br/>	
      <footer>
          <div>
            <div>Теги:</div>
            <div class="taglist">
              <ul class="tags">
                <li><a href="http://romeogolf.github.io/tag/pelican.html" class="tag">pelican</a></li>
              </ul>
            </div>
          </div>
        <br/>
        <div class="comments">
          <div id="disqus_thread"></div>
          <script type="text/javascript">
            var disqus_identifier = "pelican-i-osnovnye-nastroiki-zagotovki-saita.html";
            (function() {
              var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                  dsq.src = 'http://romeogolf.disqus.com/embed.js';
                  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                  })();
          </script>
          <noscript>
            <div>Для чтения и написания комментариев требуется включить JavaScript.</div>
	  </noscript>
        </div>
      </footer>
    </article>
  </section>
    </div> <!-- content -->
    
  </div> <!-- layout -->

  <div class="footer">
    &copy; 2016 RomeoGolf


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-72333148-1', 'auto');
  ga('send', 'pageview');

</script>

<!--    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-72333148-1']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
</script> -->
<!-- Yandex.Metrika counter -->
<script type="text/javascript">
    (function (d, w, c) {
        (w[c] = w[c] || []).push(function() {
            try {
                w.yaCounter35090040 = new Ya.Metrika({
                    id:35090040,
                    clickmap:true,
                    trackLinks:true,
                    accurateTrackBounce:true,
                    webvisor:true
                });
            } catch(e) { }
        });

        var n = d.getElementsByTagName("script")[0],
            s = d.createElement("script"),
            f = function () { n.parentNode.insertBefore(s, n); };
        s.type = "text/javascript";
        s.async = true;
        s.src = "https://mc.yandex.ru/metrika/watch.js";

        if (w.opera == "[object Opera]") {
            d.addEventListener("DOMContentLoaded", f, false);
        } else { f(); }
    })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/35090040" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->
  </div> <!-- footer -->

</body>
</html>